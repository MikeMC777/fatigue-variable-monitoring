<div class="justify-content-center row py-4">
  <div class="row form-wrapper px-xl-4 py-xl-2">
    <form onkeydown="return event.key != 'Enter'" *ngIf="loaded; else loading" [formGroup]="deviceFormGroup" class="col-12">
      <div class="row">
        <div class="col-12 row">
          <div class="row pb-0 pb-md-4 mx-0 px-0">
            <div class="col-12 col-md-3 form-group-feedback text-truncate">
              <label class="mb-1" for="referenceContent" matTooltip="Referencia" matTooltipPosition="right">Referencia</label>
              <ng-container *ngIf="router.url === '/form-device'; then createReference else editReference">
              </ng-container>
              <ng-template #createReference>
                <small class="text-danger" *ngIf="reference.hasError('required') && reference.touched">Campo requerido</small>
                <i *ngIf="!validReference && reference.touched && reference.value != null" class="float-right text-danger fa fa-times"></i>
                <i *ngIf="validReference && reference.touched && reference.value != null" class="float-right text-info fa fa-check"></i>
                <input autocomplete="off" id="referenceContent" type="text" (keydown)="onTyping($event)"
                  (change)="validateReference()" formControlName="reference" aria-describedby="referenceHelp"
                  class="form-control" [ngClass]="!validReference && reference.touched ? 'border-danger' : ''"
                  placeholder="Ingrese referencia única">
              </ng-template>
              <ng-template #editReference>
                <input autocomplete="off" type="text" formControlName="reference" class="form-control" id="referenceContent" readonly>
              </ng-template>
            </div>
            <div class="col-12 col-md-3 form-group-feedback text-truncate">
              <label class="mb-1" for="nameContent" matTooltip="Nombre" matTooltipPosition="right">Nombre</label>
              <small class="text-danger" *ngIf="name.hasError('required') && name.touched">Campo requerido</small>
              <small class="text-danger" *ngIf="name.hasError('maxlength')">Máximo 30 caracteres</small>
              <input formControlName="name" autocomplete="off" type="text" aria-describedby="nameContentHelp" class="form-control" id="nameContent" placeholder="Ingrese primer nombre">
            </div>
            <div class="col-12 col-md-6 form-group-feedback text-truncate">
              <ng-container *ngIf="router.url === '/edit-device'; then editStatus">
              </ng-container>
              <ng-template #editStatus>
                <section class="example-section">
                  <mat-checkbox class="example-margin" formControlName="status">Activo</mat-checkbox>
                </section>
              </ng-template>
            </div>
          </div>
          <div class="row pb-0 pb-md-4 mx-0 px-0">
            <div class="col-12 form-group-feedback text-truncate">
              <label class="mb-1" for="descriptionContent" matTooltip="Descripción" matTooltipPosition="right">Descripción</label>
              <small class="text-danger" *ngIf="description.hasError('maxlength')">Máximo 250 caracteres</small>
              <textarea formControlName="description" autocomplete="off" type="text" aria-describedby="descriptionContentHelp" class="form-control" id="descriptionContent" placeholder="Ingrese la descripción"></textarea>
            </div>
          </div>
        </div>
        <div class="col-12 button-container py-2">
          <button mat-raised-button class="btn btn-outline-danger mx-2" mat-button (click)="onCancel()">
            <i class="fa fa-times" aria-hidden="true"></i> Cancelar</button>
          <ng-container *ngIf="router.url === '/edit-device'; then editDeviceButton else createDeviceButton">
          </ng-container>
          <ng-template #createDeviceButton>
              <button mat-raised-button [disabled]="deviceFormGroup.invalid || !validReference || typing" class="btn btn-outline-success mx-2" mat-button (click)="onCreate()">
                <i class="fa fa-check-circle" aria-hidden="true"></i> Guardar</button>
          </ng-template>
          <ng-template #editDeviceButton>
              <button mat-raised-button [disabled]="deviceFormGroup.invalid" class="btn btn-outline-success mx-2" mat-button (click)="onUpdate()">
                <i class="fa fa-check-circle" aria-hidden="true"></i> Guardar</button>
          </ng-template>
        </div>
      </div>
    </form>
    <ng-template #loading>
      <div class="d-block justify-content-center text-center m-5">
        <div class="spinner-grow text-info" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-secondary" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-success" role="status">
          <span class="sr-only">Loading...</span>
        </div>
      </div>
    </ng-template>
  </div>
</div>

